## 학습 목록

- [Cub3D] 각각의 벽 방향 마다 서로 다른 텍스쳐 적용하기

<br><br>

## 학습 내용

### [Cub3D] 벽 방향 적용하기

<img width="1192" alt="스크린샷 2021-02-20 오후 9 05 46" src="https://user-images.githubusercontent.com/64737872/108594808-71324600-73bf-11eb-96aa-c21f5def1cce.png">

    벽의 동쪽, 북쪽, 서쪽, 남쪽 방향을 바라보는 벽 마다 서로 다른 텍스쳐를 적용한다.

#### 생각 보다 많이 어려웠고, 수학적 사고력의 필요성을 많이 느꼈다.

- 기울기를 이용하고 절편을 이용하는 등 여러 가지 수학적 이론을 생각하며 코드를 작성했지만, 역시 생각만으로 완벽한 코드를 작성하는 것은 불가능하다는 사실을 다시 깨닫게 되었다.
- 하루 종일 많은 삽질을 했다. 우선 미리 계획한 절편과 기울기를 이용한 로직을 적용해보려 했지만, 내가 작성한 DDA 알고리즘(=이하 DDA)과 적용되지 않는 다는 사실을 깨닫게 되었다.
- 그래서 DDA 알고리즘을 다시 한 번 작성해보기로 결심했다. 그러나 다른 소스파일들이 이전에 작성한 DDA에 맞추어진 파일들이라 프로그램의 많은 부분을 수정해야 한다는 사실을 깨달았다. 그것을 깨달은 때는 새로운 DDA 작성을 시작한 지 4시간이 흐른 뒤였다.
- 포기하려던 찰나, 나의 DDA를 다시 믿어보기로 하고 다른 로직을 생각해보았다. 그리고 벽과 접촉한 광선의 좌표를 활용한 방법을 이용하기로 했다.

#### 좌표를 활용한 벽 방향 구분

본인 코드에서 사용되는 DDA 알고리즘에 기반한 로직이기 때문에 다른 곳에서 동일한 적용은 불가능 할 것같다.

광선의 진행 방향이 양수일 때

- 광선의 진행 방향이 양수 즉, 좌표평면 상에서 오른쪽을 향할 때, 기울기는 0보다 크고 (x, f(x)) 혹은 (g(y), y) 이런 모양의 좌표가 나올 것이다. 예를 들어 (1, 1.4) 혹은 (1.4, 1) 과 같은 벽의 좌표를 만났다 가정한다.
- 내 코드의 DDA는 벽의 크기(TILE SIZE)와 좌표를 곱해 실수를 처리해주는 방식으로 진행된다.(바둑판 안의 바둑판 같은 느낌이다.) 이런 선행 방식에 따라, 벽의 크기가 10이라면 위에서 만난 좌표는 (10, 14) 혹은 (14, 10)이 될 것이다. 이 좌표를 각각 TILE 사이즈로 나누어 그의 나머지 값을 구한다.
- 나머지 값이 0이라면 x 절편 혹은 y 절편을 구할 수 있다. 절편의 성질을 이용해 벽의 방향을 구분한다.

광선의 진행 방향이 음수일 때

- 광선이 좌표평면 상에서 왼쪽을 향할 때, 기울기는 0보다 작고 좌표가 감소하는 모습을 보인다.
- 예를 들어 (1, 1.4) 혹은 (1.4, 1)과 같은 벽의 좌표를 만났다 가정한다.
- 위와 달리 음수의 좌표는 (9, 13) 혹은 (13, 9)와 같은 좌표를 갖고 있을 것이다. 왜냐하면 위에서 설명한 바둑판 안의 바둑판 같이 x = 1이라는 공간 안에 TILE 사이즈 만큼의 좌표평면이 더 있기 때문이다. 그리고 이 값은 배열처럼 0부터 TILE 사이즈 - 1 까지의 범위의 값을 갖는다.
- 그래서 이 값 또한 TILE 사이즈로 나누어 그의 나머지 값을 구한다.
- 나머지 값이 TILE - 1 이라면 광선의 진행 방향이 음수인 것이다.

<br><br>

## 완료한 일

- [x]  [Cub3D] 벽의 방향 적용하기
